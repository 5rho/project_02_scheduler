RD

シフトを自動で生成するwebアプリケーションを作成する。
言語はpythonで、streamlitをフレームワークとして用いる。
スタッフ個人のスケジュール、作業スキル、タスクのスケジュールをもとに、
スタッフごとのシフトを出力するアプリを作りたい。

スタッフは手分けして、タスクをこなさなければならない。
タスクは、採取、計数、単離、撮影、同定 の ５つの作業で構成されている。
同じタスクの作業は別の日に行われる。
例えば、task1の採取とtask1の計数は必ずことなる日に行われる。
異なるタスクの作業は同じ日に行われても良い。
例えば、task3の採取とtask2の撮影が同じ日に行われることは構わない。

web appが求められる機能は以下
１．スタッフ各人が個人のスケジュールを入力できる事
スタッフ各人が個人のスケジュールを入力する画面はカレンダーから日付を選択し、入力できるようにする。

２．最適なシフトを組み、誰が何日にどの作業をするのか示すこと
後述のsheet"task_schadule"と同じ形式のtableをシフト表として表示し、要素にスタッフの名前を追加して返す。
つまり、tableの要素は作業名+スタッフ名である。
ここで、"task_schdule"では1行目のB列以降にタスク名が列名として入力されているが、
uiに表示されるシフト表では、"sample"+"各タスクの一番最初の作業が行われる日付"をtableの列名として返す。
例えば、タスク1の一番最初の作業が2025/7/12に予定されているのなら、シフト表の列名は'task1'の代わりに'sample2025/7/12'と表示される。

３．スタッフごとに、シフトを示すこと
スタッフがスタッフ自身がいつ、何の作業を担当するのかわかるように、個人のシフト表 として、tableを表示する。
個人のシフト表 のtableは1列目に日付、2列目にsample"各タスクの一番最初の作業が行われる日付"+作業名が表示される。
例えば、tanakaさんが2025/8/1にタスク1(タスク1の最初の作業の日は2025/7/12)の"撮影"を割り当てられた場合は、
tanakaさんの個人のシフト表には、2025/8/1の行の2列目の要素に"sample2025/7/12_撮影"と示される。

事前に準備するエクセルファイルの構造は以下
エクセルファイル.xlsx は "task_schedule", "personal_schedule", "staff" の3枚のsheetをもち、
3枚のsheetはそれぞれデータが入力されている。
"task_schedule"の構造は以下
1行A列のセルには'date'が入力されている。
A列の2行目以降に日付が入力されている。
1行のB列目以降にはタスク名が入力されている。例: 1B=task1, 1C=task2, 1D=task3,...
すべてのタスクはそれぞれ、5つの作業で構成されている。1つの作業は1日に割り当てられてられている。
表の要素として、作業名が入力されている。
　
"personal_schedule"の構造は以下
A列の2行目以降に日付が入力されている。
A列の2行目以降に日付が入力されている。
1行のB列目以降にはスタッフの名前が入力されている。例: tanaka, takeda, tokui,...
表の要素として、x(xは作業を割り当てられない日を表す)が入力されている。
表の要素が空欄の場合、作業を割り当てることができる。

"staff"の構造は以下
A列の2行目以降にスタッフの名前が入力されている。
1行のB列以降に作業名が入力されている。例: 1B=採取, 1C=計数, 1D=単離, 1E=撮影, 1F=同定
総てのタスクはこの5つの作業で構成されている。
表の要素として、x(xはそのスタッフがその作業を割り当てられないことを表す)が入力されている。
表の要素が空欄の場合、そのスタッフはその作業を割り当てられる事が出来る。
